{% extends 'base3.html' %}
{% load static %}

{% block content %}
<div class="bg-white p-4 rounded shadow-sm">
    <h2 class="text-center mb-4">üìã –ú–æ–∏ –∑–∞–ø–∏—Å–∏</h2>

    {% if appointments %}
    <div class="table-responsive">
      <table class="table table-bordered table-hover align-middle text-center">
        <thead class="table-light">
          <tr>
            <th>–ú–∞—Å—Ç–µ—Ä</th>
            <th>–£—Å–ª—É–≥–∞</th>
            <th>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody>
          {% for appointment in appointments %}
          <tr>
            <td>{{ appointment.stylist.user.get_full_name|default:appointment.stylist.user.username }}
              {{ appointment.stylist_service.salon_service.salon.name }}
            </td>
            <td>
  {% for s in appointment.services.all %}
    {{ s.stylist_service.salon_service.service.name }}{% if not forloop.last %}, {% endif %}
  {% endfor %}
</td>
            <td>{{ appointment.start_time|date:"d.m.Y H:i" }}</td>
            <td>
              {% if appointment.status == "P" %}
              <span class="badge bg-warning text-dark">–û–∂–∏–¥–∞–µ—Ç</span>
              {% elif appointment.status == "C" %}
              <span class="badge bg-info">–ü—Ä–∏–Ω—è—Ç–æ</span>
              {% elif appointment.status == "D" %}
              <span class="badge bg-success">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</span>
              {% elif appointment.status == "canceled" %}
              <span class="badge bg-danger">–û—Ç–º–µ–Ω–µ–Ω–æ</span>
              {% endif %}
            </td>
            <td>
              {% if appointment.status == "P" or appointment.status == "C" %}
              <form method="post" action="{% url 'cancel_appointment' appointment.id %}" class="d-inline">
                {% csrf_token %}
                <button type="submit" class="btn btn-outline-danger btn-sm"
                        onclick="return confirm('–¢–æ—á–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å?')">
                  –û—Ç–º–µ–Ω–∏—Ç—å
                </button>
              </form>
              {% else %}
              <span class="text-muted">‚Äî</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <p class="text-center text-muted mt-4">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π.</p>
    {% endif %}
  </div>
{% endblock %}


