{% extends 'base3.html' %}
{% load static %}
{% block content %}

<div class="container py-4">
    <h2 class="mb-4">üìä –û—Ç—á—ë—Ç –º–∞—Å—Ç–µ—Ä–∞</h2>

    <form method="get" class="row g-3 mb-4">
        <div class="col-md-4">
            <label for="start" class="form-label">–° –¥–∞—Ç—ã:</label>
            <input type="date" id="start" name="start_date" value="{{ start_date }}" class="form-control">
        </div>
        <div class="col-md-4">
            <label for="end" class="form-label">–ü–æ –¥–∞—Ç—É:</label>
            <input type="date" id="end" name="end_date" value="{{ end_date }}" class="form-control">
        </div>
        <div class="col-md-4 d-flex align-items-end">
            <button type="submit" class="btn btn-dark w-100">–ü–æ–∫–∞–∑–∞—Ç—å</button>
        </div>
    </form>

    {% if report_appointments %}
        <div class="alert alert-success">
            üë§ –ö–ª–∏–µ–Ω—Ç–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥: <strong>{{ total_clients }}</strong><br>
            üí∞ –û–±—â–∞—è —Å—É–º–º–∞: <strong>{{ total_cash }} —Å—É–º</strong>
        </div>

        <div class="table-responsive">
            <table class="table table-bordered table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</th>
                        <th>–£—Å–ª—É–≥–∞</th>
                        <th>–ö–ª–∏–µ–Ω—Ç</th>
                        <th>–¶–µ–Ω–∞</th>
                    </tr>
                </thead>
                <tbody>
                    {% for a in report_appointments %}
                    <tr>
                        <td>{{ a.start_time|date:"Y-m-d H:i" }}</td>
                        <td>
                            {% for s in a.services.all %}
                            {{ s.stylist_service.salon_service.service.name }}{% if not forloop.last %}, {% endif %}
                            {% empty %}
                            –ù–µ—Ç —É—Å–ª—É–≥
                            {% endfor %}
                        </td>
                        <td>{{ a.guest_name }}</td>
                        <td>{{ a.get_total_price }} —Å—É–º</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% elif start_date and end_date %}
        <div class="alert alert-warning">–ù–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥.</div>
    {% endif %}
</div>


{% endblock %}
